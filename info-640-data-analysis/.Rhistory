HUVacant_sum = "B25002_003E",
Owner_MovedIn_under1yr_sum = "B25026_003E",
Owner_MovedIn_2to5yrs_sum = "B25026_004E",
Owner_MovedIn_5to10yrs_sum = "B25026_005E",
Poverty_pct = "S1701_C03_046E",
Renter_MovedIn_under1yr_sum = "B25026_010E",
Renter_MovedIn_2to5yrs_sum = "B25026_011E",
Renter_MovedIn_5to10yrs_sum = "B25026_012E",
Unemployed_sum = "B23025_005E",
Population_sum = "B02001_001E",
Asian_sum = "B02001_005E",
Black_sum = "B02001_003E",
Hispanic_sum = "B03001_003E",
White_sum = "B02001_002E"
)
## get the data
data <- get_acs(geography = "tract",
state = c("NY", "NJ", "CT", "PA"),
variables = variables,
output = "wide",
survey = "acs5",
year = 2023,
geometry = TRUE)
ls(data)
### map it just to be sure
ggplot(data) +
geom_sf(fill = "gray", color = "black", size = .05) +
coord_sf(crs = 26918) +
theme_minimal() +
labs(title = "Census tracts in the CBSA region")
## finally, clean up the data
data <- within(data, {
Bach_pct <- ((Ed_Bach_sum + Ed_Masters_sum + Ed_ProfDegree_sum +
Ed_Doctorate_sum) / Adults_sum) * 100
ConRent_mean <- ConRent_agg / HURenter_sum
FamilyHH_pct <- (FamilyHH_sum / Households_sum) * 100
HHIncome_mean <- HHIncome_agg / Households_sum
HouseValue_mean <- HouseValue_agg / HURenter_sum
HouseValue_Mortgaged_mean <- HouseValue_Mortgaged_agg / HUOwner_sum
HUMultiFam_sum <- HouseUnits_sum - HUSingleFam_detached_sum + HUSingleFam_attached_sum
HUMultiFam_pct <- (HUMultiFam_sum / HouseUnits_sum) * 100
HUSingleFam_sum <- HUSingleFam_detached_sum + HUSingleFam_attached_sum
HUSingleFam_pct <- (HUSingleFam_sum / HouseUnits_sum) * 100
HUNewConstruction_sum <- HUNew_under5yrs_sum + HUNew_6to10yrs_sum
HUNewConstruction_pct <- (HUNewConstruction_sum / HouseUnits_sum) * 100
HUOwner_pct <- (HUOwner_sum / HouseUnits_sum) * 100
HURenter_pct <- (HURenter_sum / HouseUnits_sum) * 100
HUVacant_pct <- (HUVacant_sum / HouseUnits_sum) * 100
MovedIn_under10yrs_sum <- Owner_MovedIn_under1yr_sum + Owner_MovedIn_2to5yrs_sum +
Owner_MovedIn_5to10yrs_sum + Renter_MovedIn_under1yr_sum +
Renter_MovedIn_2to5yrs_sum + Renter_MovedIn_5to10yrs_sum
MovedIn_under10yrs_pct <- (MovedIn_under10yrs_sum / HUOccupied_sum) * 100
Unemployed_pct <- (Employed_sum / LaborForce_sum) * 100
Asian_pct <- (Asian_sum / Population_sum) * 100
Black_pct <- (Black_sum / Population_sum) * 100
Hispanic_pct <- (Hispanic_sum / Population_sum) * 100
White_pct <- (White_sum / Population_sum) * 100
PlaceType <- ifelse(grepl("Bronx County|Kings County|New York County|
Queens County|Richmond County", NAME.1), "City", "Suburb")
})
## finally, clean up the data
data <- within(data, {
Bach_pct <- ((Ed_Bach_sum + Ed_Masters_sum + Ed_ProfDegree_sum +
Ed_Doctorate_sum) / Adults_sum) * 100
ConRent_mean <- ConRent_agg / HURenter_sum
FamilyHH_pct <- (FamilyHH_sum / Households_sum) * 100
HHIncome_mean <- HHIncome_agg / Households_sum
HouseValue_mean <- HouseValue_agg / HURenter_sum
HouseValue_Mortgaged_mean <- HouseValue_Mortgaged_agg / HUOwner_sum
HUMultiFam_sum <- HouseUnits_sum - HUSingleFam_detached_sum + HUSingleFam_attached_sum
HUMultiFam_pct <- (HUMultiFam_sum / HouseUnits_sum) * 100
HUSingleFam_sum <- HUSingleFam_detached_sum + HUSingleFam_attached_sum
HUSingleFam_pct <- (HUSingleFam_sum / HouseUnits_sum) * 100
HUNewConstruction_sum <- HUNew_under5yrs_sum + HUNew_6to10yrs_sum
HUNewConstruction_pct <- (HUNewConstruction_sum / HouseUnits_sum) * 100
HUOwner_pct <- (HUOwner_sum / HouseUnits_sum) * 100
HURenter_pct <- (HURenter_sum / HouseUnits_sum) * 100
HUVacant_pct <- (HUVacant_sum / HouseUnits_sum) * 100
MovedIn_under10yrs_sum <- Owner_MovedIn_under1yr_sum + Owner_MovedIn_2to5yrs_sum +
Owner_MovedIn_5to10yrs_sum + Renter_MovedIn_under1yr_sum +
Renter_MovedIn_2to5yrs_sum + Renter_MovedIn_5to10yrs_sum
MovedIn_under10yrs_pct <- (MovedIn_under10yrs_sum / HUOccupied_sum) * 100
Unemployed_pct <- (Unemployed_sum / LaborForce_sum) * 100
Asian_pct <- (Asian_sum / Population_sum) * 100
Black_pct <- (Black_sum / Population_sum) * 100
Hispanic_pct <- (Hispanic_sum / Population_sum) * 100
White_pct <- (White_sum / Population_sum) * 100
PlaceType <- ifelse(grepl("Bronx County|Kings County|New York County|
Queens County|Richmond County", NAME.1), "City", "Suburb")
})
PlaceType <- ifelse(grepl("Bronx County|Kings County|New York County|
Queens County|Richmond County", NAME), "City", "Suburb")
View(data)
## finally, clean up the data
data <- within(data, {
Bach_pct <- ((Ed_Bach_sum + Ed_Masters_sum + Ed_ProfDegree_sum +
Ed_Doctorate_sum) / Adults_sum) * 100
ConRent_mean <- ConRent_agg / HURenter_sum
FamilyHH_pct <- (FamilyHH_sum / Households_sum) * 100
HHIncome_mean <- HHIncome_agg / Households_sum
HouseValue_mean <- HouseValue_agg / HURenter_sum
HouseValue_Mortgaged_mean <- HouseValue_Mortgaged_agg / HUOwner_sum
HUMultiFam_sum <- HouseUnits_sum - HUSingleFam_detached_sum + HUSingleFam_attached_sum
HUMultiFam_pct <- (HUMultiFam_sum / HouseUnits_sum) * 100
HUSingleFam_sum <- HUSingleFam_detached_sum + HUSingleFam_attached_sum
HUSingleFam_pct <- (HUSingleFam_sum / HouseUnits_sum) * 100
HUNewConstruction_sum <- HUNew_under5yrs_sum + HUNew_6to10yrs_sum
HUNewConstruction_pct <- (HUNewConstruction_sum / HouseUnits_sum) * 100
HUOwner_pct <- (HUOwner_sum / HouseUnits_sum) * 100
HURenter_pct <- (HURenter_sum / HouseUnits_sum) * 100
HUVacant_pct <- (HUVacant_sum / HouseUnits_sum) * 100
MovedIn_under10yrs_sum <- Owner_MovedIn_under1yr_sum + Owner_MovedIn_2to5yrs_sum +
Owner_MovedIn_5to10yrs_sum + Renter_MovedIn_under1yr_sum +
Renter_MovedIn_2to5yrs_sum + Renter_MovedIn_5to10yrs_sum
MovedIn_under10yrs_pct <- (MovedIn_under10yrs_sum / HUOccupied_sum) * 100
Unemployed_pct <- (Unemployed_sum / LaborForce_sum) * 100
Asian_pct <- (Asian_sum / Population_sum) * 100
Black_pct <- (Black_sum / Population_sum) * 100
Hispanic_pct <- (Hispanic_sum / Population_sum) * 100
White_pct <- (White_sum / Population_sum) * 100
PlaceType <- ifelse(grepl("Bronx County|Kings County|New York County|
Queens County|Richmond County", NAME), "City", "Suburb")
})
View(data)
matrix <- data %>%
mutate(
Bach_pct = ((Ed_Bach_sum + Ed_Masters_sum + Ed_ProfDegree_sum + Ed_Doctorate_sum) / Adults_sum) * 100,
ConRent_mean = ConRent_agg / HURenter_sum,
FamilyHH_pct = (FamilyHH_sum / Households_sum) * 100,
HHIncome_mean = HHIncome_agg / Households_sum,
HouseValue_mean = HouseValue_agg / HURenter_sum,
HouseValue_Mortgaged_mean = HouseValue_Mortgaged_agg / HUOwner_sum,
HUMultiFam_sum = HouseUnits_sum - HUSingleFam_detached_sum + HUSingleFam_attached_sum,
HUMultiFam_pct = (HUMultiFam_sum / HouseUnits_sum) * 100,
HUSingleFam_sum = HUSingleFam_detached_sum + HUSingleFam_attached_sum,
HUSingleFam_pct = (HUSingleFam_sum / HouseUnits_sum) * 100,
HUNewConstruction_sum = HUNew_under5yrs_sum + HUNew_6to10yrs_sum,
HUNewConstruction_pct = (HUNewConstruction_sum / HouseUnits_sum) * 100,
HUOwner_pct = (HUOwner_sum / HouseUnits_sum) * 100,
HURenter_pct = (HURenter_sum / HouseUnits_sum) * 100,
HUVacant_pct = (HUVacant_sum / HouseUnits_sum) * 100,
MovedIn_under10yrs_sum = Owner_MovedIn_under1yr_sum + Owner_MovedIn_2to5yrs_sum +
Owner_MovedIn_5to10yrs_sum + Renter_MovedIn_under1yr_sum +
Renter_MovedIn_2to5yrs_sum + Renter_MovedIn_5to10yrs_sum,
MovedIn_under10yrs_pct = (MovedIn_under10yrs_sum / HUOccupied_sum) * 100,
Unemployed_pct = (Unemployed_sum / LaborForce_sum) * 100,
Asian_pct = (Asian_sum / Population_sum) * 100,
Black_pct = (Black_sum / Population_sum) * 100,
Hispanic_pct = (Hispanic_sum / Population_sum) * 100,
White_pct = (White_sum / Population_sum) * 100,
PlaceType = ifelse(grepl("Bronx County|Kings County|New York County|Queens County|Richmond County", NAME),
"City", "Suburb")
)
View(matrix)
matrix <- data %>%
mutate(
Bach_pct = ((Ed_Bach_sum + Ed_Masters_sum + Ed_ProfDegree_sum + Ed_Doctorate_sum) / Adults_sum) * 100,
ConRent_mean = ConRent_agg / HURenter_sum,
FamilyHH_pct = (FamilyHH_sum / Households_sum) * 100,
HHIncome_mean = HHIncome_agg / Households_sum,
HouseValue_mean = HouseValue_agg / HURenter_sum,
HouseValue_Mortgaged_mean = HouseValue_Mortgaged_agg / HUOwner_sum,
HUMultiFam_sum = HouseUnits_sum - HUSingleFam_detached_sum + HUSingleFam_attached_sum,
HUMultiFam_pct = (HUMultiFam_sum / HouseUnits_sum) * 100,
HUSingleFam_sum = HUSingleFam_detached_sum + HUSingleFam_attached_sum,
HUSingleFam_pct = (HUSingleFam_sum / HouseUnits_sum) * 100,
HUNewConstruction_sum = HUNew_under5yrs_sum + HUNew_6to10yrs_sum,
HUNewConstruction_pct = (HUNewConstruction_sum / HouseUnits_sum) * 100,
HUOwner_pct = (HUOwner_sum / HouseUnits_sum) * 100,
HURenter_pct = (HURenter_sum / HouseUnits_sum) * 100,
HUVacant_pct = (HUVacant_sum / HouseUnits_sum) * 100,
MovedIn_under10yrs_sum = Owner_MovedIn_under1yr_sum + Owner_MovedIn_2to5yrs_sum +
Owner_MovedIn_5to10yrs_sum + Renter_MovedIn_under1yr_sum +
Renter_MovedIn_2to5yrs_sum + Renter_MovedIn_5to10yrs_sum,
MovedIn_under10yrs_pct = (MovedIn_under10yrs_sum / HUOccupied_sum) * 100,
Unemployed_pct = (Unemployed_sum / LaborForce_sum) * 100,
Asian_pct = (Asian_sum / Population_sum) * 100,
Black_pct = (Black_sum / Population_sum) * 100,
Hispanic_pct = (Hispanic_sum / Population_sum) * 100,
White_pct = (White_sum / Population_sum) * 100) %>%
select(
Bach_pct, ConRent_mean, FamilyHH_pct, HHIncome_mean, HouseValue_mean,
HouseValue_Mortgaged_mean, HUMultiFam_sum, HUMultiFam_pct,
HUSingleFam_sum, HUSingleFam_pct, HUNewConstruction_sum, HUNewConstruction_pct,
HUOwner_pct, HURenter_pct, HUVacant_pct, MovedIn_under10yrs_sum,
MovedIn_under10yrs_pct, Unemployed_pct, Asian_pct, Black_pct,
Hispanic_pct, White_pct, PlaceType
)
View(matrix)
matrix <- data %>%
mutate(
Bach_pct = ((Ed_Bach_sum + Ed_Masters_sum + Ed_ProfDegree_sum + Ed_Doctorate_sum) / Adults_sum) * 100,
ConRent_mean = ConRent_agg / HURenter_sum,
FamilyHH_pct = (FamilyHH_sum / Households_sum) * 100,
HHIncome_mean = HHIncome_agg / Households_sum,
HouseValue_mean = HouseValue_agg / HURenter_sum,
HouseValue_Mortgaged_mean = HouseValue_Mortgaged_agg / HUOwner_sum,
HUMultiFam_sum = HouseUnits_sum - HUSingleFam_detached_sum + HUSingleFam_attached_sum,
HUMultiFam_pct = (HUMultiFam_sum / HouseUnits_sum) * 100,
HUSingleFam_sum = HUSingleFam_detached_sum + HUSingleFam_attached_sum,
HUSingleFam_pct = (HUSingleFam_sum / HouseUnits_sum) * 100,
HUNewConstruction_sum = HUNew_under5yrs_sum + HUNew_6to10yrs_sum,
HUNewConstruction_pct = (HUNewConstruction_sum / HouseUnits_sum) * 100,
HUOwner_pct = (HUOwner_sum / HouseUnits_sum) * 100,
HURenter_pct = (HURenter_sum / HouseUnits_sum) * 100,
HUVacant_pct = (HUVacant_sum / HouseUnits_sum) * 100,
MovedIn_under10yrs_sum = Owner_MovedIn_under1yr_sum + Owner_MovedIn_2to5yrs_sum +
Owner_MovedIn_5to10yrs_sum + Renter_MovedIn_under1yr_sum +
Renter_MovedIn_2to5yrs_sum + Renter_MovedIn_5to10yrs_sum,
MovedIn_under10yrs_pct = (MovedIn_under10yrs_sum / HUOccupied_sum) * 100,
Unemployed_pct = (Unemployed_sum / LaborForce_sum) * 100,
Asian_pct = (Asian_sum / Population_sum) * 100,
Black_pct = (Black_sum / Population_sum) * 100,
Hispanic_pct = (Hispanic_sum / Population_sum) * 100,
White_pct = (White_sum / Population_sum) * 100) %>%
select(
Bach_pct, ConRent_mean, FamilyHH_pct, HHIncome_mean, HouseValue_mean,
HouseValue_Mortgaged_mean, HUMultiFam_sum, HUMultiFam_pct,
HUSingleFam_sum, HUSingleFam_pct, HUNewConstruction_sum, HUNewConstruction_pct,
HUOwner_pct, HURenter_pct, HUVacant_pct, MovedIn_under10yrs_sum,
MovedIn_under10yrs_pct, Unemployed_pct, Asian_pct, Black_pct,
Hispanic_pct, White_pct
)
View(matrix)
matrix <- data %>%
mutate(
Bach_pct = ((Ed_Bach_sum + Ed_Masters_sum + Ed_ProfDegree_sum + Ed_Doctorate_sum) / Adults_sum) * 100,
ConRent_mean = ConRent_agg / HURenter_sum,
FamilyHH_pct = (FamilyHH_sum / Households_sum) * 100,
HHIncome_mean = HHIncome_agg / Households_sum,
HouseValue_mean = HouseValue_agg / HURenter_sum,
HouseValue_Mortgaged_mean = HouseValue_Mortgaged_agg / HUOwner_sum,
HUMultiFam_sum = HouseUnits_sum - HUSingleFam_detached_sum + HUSingleFam_attached_sum,
HUMultiFam_pct = (HUMultiFam_sum / HouseUnits_sum) * 100,
HUSingleFam_sum = HUSingleFam_detached_sum + HUSingleFam_attached_sum,
HUSingleFam_pct = (HUSingleFam_sum / HouseUnits_sum) * 100,
HUNewConstruction_sum = HUNew_under5yrs_sum + HUNew_6to10yrs_sum,
HUNewConstruction_pct = (HUNewConstruction_sum / HouseUnits_sum) * 100,
HUOwner_pct = (HUOwner_sum / HouseUnits_sum) * 100,
HURenter_pct = (HURenter_sum / HouseUnits_sum) * 100,
HUVacant_pct = (HUVacant_sum / HouseUnits_sum) * 100,
MovedIn_under10yrs_sum = Owner_MovedIn_under1yr_sum + Owner_MovedIn_2to5yrs_sum +
Owner_MovedIn_5to10yrs_sum + Renter_MovedIn_under1yr_sum +
Renter_MovedIn_2to5yrs_sum + Renter_MovedIn_5to10yrs_sum,
MovedIn_under10yrs_pct = (MovedIn_under10yrs_sum / HUOccupied_sum) * 100,
Unemployed_pct = (Unemployed_sum / LaborForce_sum) * 100,
Asian_pct = (Asian_sum / Population_sum) * 100,
Black_pct = (Black_sum / Population_sum) * 100,
Hispanic_pct = (Hispanic_sum / Population_sum) * 100,
White_pct = (White_sum / Population_sum) * 100) %>%
select(
Bach_pct, ConRent_mean, FamilyHH_pct, HHIncome_mean, HouseValue_mean,
HouseValue_Mortgaged_mean, HUMultiFam_sum, HUMultiFam_pct,
HUSingleFam_sum, HUSingleFam_pct, HUNewConstruction_sum, HUNewConstruction_pct,
HUOwner_pct, HURenter_pct, HUVacant_pct, MovedIn_under10yrs_sum,
MovedIn_under10yrs_pct, Unemployed_pct, Asian_pct, Black_pct,
Hispanic_pct, White_pct) %>%
st_drop_geometry()
View(matrix)
### clip only those tracts that spatially intersect with CBSA boundaries
test <- st_intersection(x = data, y = cbsa_boundary)
### clip only those tracts that spatially intersect with CBSA boundaries
test <- st_within(data, cbsa_boundary)
View(test)
### clip only those tracts that spatially intersect with CBSA boundaries
test <- st_intersection(data, cbsa_boundary)
View(test)
### clip only those tracts that spatially intersect with CBSA boundaries
data <- st_intersection(data, cbsa_boundary)
## finally, clean up the data
matrix <- data %>%
mutate(
Bach_pct = ((Ed_Bach_sum + Ed_Masters_sum + Ed_ProfDegree_sum + Ed_Doctorate_sum) / Adults_sum) * 100,
ConRent_mean = ConRent_agg / HURenter_sum,
FamilyHH_pct = (FamilyHH_sum / Households_sum) * 100,
HHIncome_mean = HHIncome_agg / Households_sum,
HouseValue_mean = HouseValue_agg / HURenter_sum,
HouseValue_Mortgaged_mean = HouseValue_Mortgaged_agg / HUOwner_sum,
HUMultiFam_sum = HouseUnits_sum - HUSingleFam_detached_sum + HUSingleFam_attached_sum,
HUMultiFam_pct = (HUMultiFam_sum / HouseUnits_sum) * 100,
HUSingleFam_sum = HUSingleFam_detached_sum + HUSingleFam_attached_sum,
HUSingleFam_pct = (HUSingleFam_sum / HouseUnits_sum) * 100,
HUNewConstruction_sum = HUNew_under5yrs_sum + HUNew_6to10yrs_sum,
HUNewConstruction_pct = (HUNewConstruction_sum / HouseUnits_sum) * 100,
HUOwner_pct = (HUOwner_sum / HouseUnits_sum) * 100,
HURenter_pct = (HURenter_sum / HouseUnits_sum) * 100,
HUVacant_pct = (HUVacant_sum / HouseUnits_sum) * 100,
MovedIn_under10yrs_sum = Owner_MovedIn_under1yr_sum + Owner_MovedIn_2to5yrs_sum +
Owner_MovedIn_5to10yrs_sum + Renter_MovedIn_under1yr_sum +
Renter_MovedIn_2to5yrs_sum + Renter_MovedIn_5to10yrs_sum,
MovedIn_under10yrs_pct = (MovedIn_under10yrs_sum / HUOccupied_sum) * 100,
Unemployed_pct = (Unemployed_sum / LaborForce_sum) * 100,
Asian_pct = (Asian_sum / Population_sum) * 100,
Black_pct = (Black_sum / Population_sum) * 100,
Hispanic_pct = (Hispanic_sum / Population_sum) * 100,
White_pct = (White_sum / Population_sum) * 100) %>%
select(
Bach_pct, ConRent_mean, FamilyHH_pct, HHIncome_mean, HouseValue_mean,
HouseValue_Mortgaged_mean, HUMultiFam_sum, HUMultiFam_pct,
HUSingleFam_sum, HUSingleFam_pct, HUNewConstruction_sum, HUNewConstruction_pct,
HUOwner_pct, HURenter_pct, HUVacant_pct, MovedIn_under10yrs_sum,
MovedIn_under10yrs_pct, Unemployed_pct, Asian_pct, Black_pct,
Hispanic_pct, White_pct) %>%
st_drop_geometry()
library(factoextra)
library(psych)
cortest.bartlett(R = matrix,
n = nrow(matrix),
diag = TRUE)
cortest.bartlett(R = matrix)
test <- as.matrix(matrix)
cortest.bartlett(R = test)
## finally, clean up the data
data_clean <- data %>%
mutate(
Bach_pct = ((Ed_Bach_sum + Ed_Masters_sum + Ed_ProfDegree_sum + Ed_Doctorate_sum) / Adults_sum) * 100,
ConRent_mean = ConRent_agg / HURenter_sum,
FamilyHH_pct = (FamilyHH_sum / Households_sum) * 100,
HHIncome_mean = HHIncome_agg / Households_sum,
HouseValue_mean = HouseValue_agg / HURenter_sum,
HouseValue_Mortgaged_mean = HouseValue_Mortgaged_agg / HUOwner_sum,
HUMultiFam_sum = HouseUnits_sum - HUSingleFam_detached_sum + HUSingleFam_attached_sum,
HUMultiFam_pct = (HUMultiFam_sum / HouseUnits_sum) * 100,
HUSingleFam_sum = HUSingleFam_detached_sum + HUSingleFam_attached_sum,
HUSingleFam_pct = (HUSingleFam_sum / HouseUnits_sum) * 100,
HUNewConstruction_sum = HUNew_under5yrs_sum + HUNew_6to10yrs_sum,
HUNewConstruction_pct = (HUNewConstruction_sum / HouseUnits_sum) * 100,
HUOwner_pct = (HUOwner_sum / HouseUnits_sum) * 100,
HURenter_pct = (HURenter_sum / HouseUnits_sum) * 100,
HUVacant_pct = (HUVacant_sum / HouseUnits_sum) * 100,
MovedIn_under10yrs_sum = Owner_MovedIn_under1yr_sum + Owner_MovedIn_2to5yrs_sum +
Owner_MovedIn_5to10yrs_sum + Renter_MovedIn_under1yr_sum +
Renter_MovedIn_2to5yrs_sum + Renter_MovedIn_5to10yrs_sum,
MovedIn_under10yrs_pct = (MovedIn_under10yrs_sum / HUOccupied_sum) * 100,
Unemployed_pct = (Unemployed_sum / LaborForce_sum) * 100,
Asian_pct = (Asian_sum / Population_sum) * 100,
Black_pct = (Black_sum / Population_sum) * 100,
Hispanic_pct = (Hispanic_sum / Population_sum) * 100,
White_pct = (White_sum / Population_sum) * 100) %>%
select(
Bach_pct, ConRent_mean, FamilyHH_pct, HHIncome_mean, HouseValue_mean,
HouseValue_Mortgaged_mean, HUMultiFam_sum, HUMultiFam_pct,
HUSingleFam_sum, HUSingleFam_pct, HUNewConstruction_sum, HUNewConstruction_pct,
HUOwner_pct, HURenter_pct, HUVacant_pct, MovedIn_under10yrs_sum,
MovedIn_under10yrs_pct, Unemployed_pct, Asian_pct, Black_pct,
Hispanic_pct, White_pct) %>%
st_drop_geometry()
matrix <- as.matrix(data_clean)
cortest.bartlett(matrix)
cortest.bartlett(R = matrix, n = nrow(matrix))
cortest.bartlett(R = matrix, n = nrow(na.omit(matrix)))
KMO(matrix)
KMO(data_clean)
KMO(na.omit(data_clean))
matrix <- na.omit(data_clean)
KMO(matrix)
cortest.bartlett(matrix)
cortest.bartlett(data_clean)
cortest.bartlett(na.omit(data_clean))
KMO(na.omit(data_clean))
pca <- principal(r = data_clean,
scores = TRUE,
impute = "median",
use = "pairwise",
rotate = "none")
pca <- principal(r = data_clean,
scores = TRUE,
impute = "median",
rotate = "none")
pca <- principal(r = data_clean)
pca <- principal(r = na.omit(data_clean))
summary(pca)
library(rela)
paf.pca = paf(data_clean, eigcrit = 1, convcrit = .001)
paf.pca
paf.pca = paf(na.omit(data_clean), eigcrit = 1, convcrit = .001)
pca.matrix <- as.matrix(pca.data)
pca.matrix <- as.matrix(data_clean)
paf.pca = paf(na.omit(data_clean), eigcrit = 1, convcrit = .001)
paf.pca = paf(pca.matrix, eigcrit = 1, convcrit = .001)
pca <- principal(r = data_clean,
impute = "mean")
pca <- principal(r = na.omit(data_clean),
impute = "mean")
summary(pca)
View(data_clean)
principal(r = data_clean, covar = TRUE, rotate = "varimax")
principal(r = data_clean, nfactors = 5, residuals = TRUE, scores = TRUE, missing = TRUE, covar = TRUE, rotate = "varimax")
principal(r = data_clean,
nfactors = 5,
residuals = TRUE,
rorate = "varimax",
n.obs = nrow(data_clean),
covar = TRUE,
scores = TRUE,
missing = TRUE,
impute = "median",
method = "cor")
principal(r = data_clean,
nfactors = 5,
residuals = TRUE,
rorate = "varimax",
n.obs = nrow(data_clean),
covar = TRUE,
scores = TRUE,
missing = TRUE,
impute = "mean",
method = "cor")
principal(r = data_clean,
nfactors = 5,
residuals = TRUE,
rorate = "varimax",
n.obs = nrow(data_clean),
covar = TRUE,
scores = TRUE,
missing = TRUE,
impute = "mean",
use = "pairwise",
method = "cor")
principal(r = na.omit(data_clean),
nfactors = 5,
residuals = TRUE,
rorate = "varimax",
n.obs = nrow(data_clean),
covar = TRUE,
scores = TRUE,
missing = TRUE,
impute = "mean",
use = "pairwise",
method = "cor")
principal(r = na.omit(data_clean),
nfactors = 5,
residuals = TRUE,
rotate = "varimax",
n.obs = nrow(data_clean),
covar = TRUE,
scores = TRUE,
missing = TRUE,
impute = "mean",
use = "pairwise",
method = "cor")
principal(r = na.omit(data_clean),
nfactors = 5,
residuals = TRUE,
rotate = "none",
n.obs = nrow(data_clean),
covar = TRUE,
scores = TRUE,
missing = TRUE,
impute = "mean",
use = "pairwise",
method = "cor")
pca <- principal(r = na.omit(data_clean),
nfactors = 5,
residuals = TRUE,
rotate = "none",
n.obs = nrow(data_clean),
covar = TRUE,
scores = TRUE,
missing = TRUE,
impute = "mean",
use = "pairwise",
method = "cor")
pca
print(pca)
plot(pca)
plot(pca, type = "lines")
pca <- principal(r = na.omit(data_clean),
nfactors = ncol(data_clean),
residuals = TRUE,
rotate = "none",
n.obs = nrow(data_clean),
covar = TRUE,
scores = TRUE,
missing = TRUE,
impute = "mean",
use = "pairwise",
method = "cor")
print(pca)
plot(pca, type = "lines")
pca <- principal(r = na.omit(data_clean),
nfactors = 5,
residuals = TRUE,
rotate = "none",
n.obs = nrow(data_clean),
covar = TRUE,
scores = TRUE,
missing = TRUE,
impute = "mean",
use = "pairwise",
method = "cor")
print(pca)
cor_mat <- cor(na.omit(data_clean), use = "pairwise.complete.obs")
scree(cor_mat)
names(pca)
## scree plot
correlations <- cor(na.omit(data_clean), use = "pairwise.complete.obs")
scree(correlations)
## run PCA
pca <- principal(r = na.omit(data_clean),
nfactors = 7,
residuals = TRUE,
rotate = "none",
n.obs = nrow(data_clean),
covar = TRUE,
scores = TRUE,
missing = TRUE,
impute = "mean",
use = "pairwise",
method = "cor")
print(pca)
names(pca)
